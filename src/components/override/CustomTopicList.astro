---
import { Icon } from "@astrojs/starlight/components";
const { topics } = Astro.locals.starlightSidebarTopics;
---

<nav class="topic-nav">
  {
    topics.map((topic) => (
      <a
        href={topic.link}
        class={`topic-item ${topic.isCurrent ? "active" : ""}`}
        aria-current={topic.isCurrent ? "page" : undefined}
      >
        {topic.icon && (
          <span class={`icon-wrapper icon-${topic.icon?.replace(":", "-")}`}>
            <Icon name={topic.icon} />
          </span>
        )}
        <span class="label">{topic.label}</span>
      </a>
    ))
  }
</nav>

<style>
  :root {
    --drop-color: blue;
  }

  /* 2. Dark Mode (Specific to Starlight/Astro logic) */
  :global([data-theme='dark']) {
    --drop-color: lightblue;
  }

  :root {
    /* Deep Crimson: Better contrast against light backgrounds (Starlight White) */
    --heart-red: #D32F2F; 
  }

  :global([data-theme='dark']) {
    /* Soft Coral Red: Prevents "vibrating" on dark backgrounds and reduces eye strain */
    --heart-red: #FF5252; 
  }

  .topic-nav {
    display: flex;
    flex-direction: column;
    gap: 2px;
    margin-bottom: 1rem;
  }

  /* Match Starlight item rhythm */
  .topic-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 4px 12px;
    border-radius: 8px;
    text-decoration: none;
    line-height: 1.4;
    color: var(--sl-color-text);
    transition: background 0.35s ease;
  }

  /* Hover */
  .topic-item:hover {
    background: var(--sl-color-gray-5);
  }

  /* Active */
  .topic-item.active {
    background: var(--sl-color-accent-low);
    color: var(--sl-color-accent-high);
    font-weight: 500;
  }

  .icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    background: var(--sl-color-gray-6);
    border: 1px solid var(--sl-color-gray-5);
    flex-shrink: 0;
    color: var(--sl-color-text);
    transition: all 0.2s ease;
  }

  /* Make SVG inherit color */
  .icon-wrapper svg {
    width: 16px;
    height: 16px;
    color: inherit;
    fill: currentColor;
    stroke: currentColor;
    transform-origin: center;
    transition:
      color 0.2s ease,
      fill 0.2s ease,
      stroke 0.2s ease;
  }

  /* Hover effect */
  .topic-item:hover .icon-wrapper {
    background: var(--sl-color-accent-low);
    border-color: var(--sl-color-accent);
    color: var(--sl-color-accent-high);
  }

  /* Active state */
  .topic-item.active .icon-wrapper {
    background: var(--sl-color-accent);
    border-color: var(--sl-color-accent);
    color: var(--sl-color-text-invert);
  }
  /* üí° Bulb Glow (seti:smarty) */
  @keyframes bulbGlow {
    0%,
    3%,
    12%,
    18%,
    25%,
    35%,
    100% {
      background-color: var(--sl-color-accent);
      box-shadow: 0 0 20px 10px color-mix(in srgb, var(--sl-color-accent), transparent 40%); Glow */
      color: var(--sl-color-text-invert);
      opacity: 1;
    }
    2%,
    8%,
    15%,
    20%,
    30% {
      background-color: transparent;
      box-shadow: none;
      color: var(--sl-color-text-invert);
      opacity: 0.3;
    }
  }

  .topic-item:hover .icon-seti-smarty {
    animation: bulbGlow 1.6s ease-in-out infinite;
  }

  /* üí™ Arm Rotate (seti:bicep) */
  @keyframes armRotate {
    0% {
      transform: rotate(0deg);
    }
    50% {
      transform: rotate(-35deg);
    }
    100% {
      transform: rotate(0deg);
    }
  }

  .topic-item:hover .icon-seti-bicep svg {
    animation: armRotate 0.6s ease-in-out infinite;
  }

  @keyframes heartPulse {
    0%, 100% { transform: scale(1); color: var(--drop-color); }
    14% { transform: scale(1.2); color: var(--heart-red); }
    28% { transform: scale(1); }
    42% { transform: scale(1.35); color: var(--heart-red); }
    70% { transform: scale(1); }
  }

  .topic-item:hover .icon-heart svg {
    animation: heartPulse 0.8s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    transform-origin: center;
    /* Uses the same theme-aware red for the glow */
    filter: drop-shadow(0 0 8px var(--heart-red));
  }

  /* üíß Drop Bounce (seti:elixir) */
  @keyframes dropBounce {
    0%,
    100% {
      transform: translateY(0);
       color: var(--drop-color); 
    }
    50% {
      transform: translateY(7px);
    }
  }

  .topic-item:hover .icon-seti-elixir svg {
    animation: dropBounce 0.8s ease-in-out infinite;
  }

  /* ‚ú® Starlight Spin (starlight icon) */
  @keyframes starSpin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(180deg);
    }
  }

  .topic-item:hover .icon-starlight svg {
    animation: starSpin 1s linear infinite;
  }

  /* ‚ö†Ô∏è Warning Shake (seti:warning) */
  @keyframes warningShake {
    0% {
      background-color: red;
      transform: scale(1);
      opacity: 1;
      color: white;
    }
    50% {
      /* background-color: transparent; */
      transform: scale(1.2); /* Increases size */
      opacity: 0.7;
      color: white;
    }
    100% {
      background-color: red;
      transform: scale(1); /* Decreases back to original */
      opacity: 1;
      color: white;
    }
  }

  .topic-item:hover .icon-warning {
    animation: warningShake 0.8s ease-in-out infinite;
  }

  .label {
    flex: 1;
  }
</style>
